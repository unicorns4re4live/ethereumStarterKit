<!DOCTYPE html>
<html>
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WHT4PS2');</script>
  <!-- End Google Tag Manager -->  
  <meta charset="utf-8">
  <meta name="description" content="The Truffle suite of tools make dapp development easier and more consistent.">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <!-- Favicon -->
  <link rel="icon" href="https://www.trufflesuite.com/img/favicons/favicon.ico">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Truffle Suite">
  <link rel="icon" sizes="192x192" href="https://www.trufflesuite.com/img/favicons/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Truffle Suite">
  <link rel="apple-touch-icon" href="https://www.trufflesuite.com/img/favicons/apple-touch-icon.png">

  <!-- Tile icon for Win8/10 (144x144 + tile color) -->
  <meta name="msapplication-TileImage" content="img/favicons/ms-touch-icon-144x144-precomposed.png">
  <meta name="msapplication-TileColor" content="#3372DF">

  <!-- Facebook OpenGraph -->
  <meta property="og:site_name" content="Truffle Suite" />
  <meta property="og:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta property="og:title" content="Drizzle | Contract Interaction | Documentation | Truffle Suite" />
  <meta property="og:url" content="https://trufflesuite.com/docs/drizzle/getting-started/contract-interacti" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="https://truffleframework.com/img/favicons/truffle-share.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="Truffle Suite" />
  <meta name="twitter:title" content="Drizzle | Contract Interaction | Documentation | Truffle Suite" />
  <meta name="twitter:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta name="twitter:creator" content="Truffle Suite" />
  <meta name="twitter:domain" content="trufflesuite.com" />
  <meta name="twitter:image:src" content="https://truffleframework.com/img/favicons/truffle-share.png" />
  
  <meta name="google-site-verification" content="BSgPkMHzw7IxJTpEElNfD8ZZYPzXgOQiTVPzAxAG8-o" />

  <title>Drizzle | Contract Interaction | Documentation | Truffle Suite</title>

  <link href="https://fonts.googleapis.com/css?family=Grand+Hotel|Open+Sans|Oswald|Varela+Round|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous">
  <link rel="stylesheet" href="../../../css/index.css">
</head>
<body>
 

    

    <div class="row row-docs-main">
      <aside class="col-lg-3 docs-sidebar" id="docsSidebar">
        
      
        <a class="toggle-drizzle suite-link" href="contract-interaction.html#drizzleDocs" data-toggle="collapse">
          <img class="suite-logo" src="../../../img/drizzle-logomark.svg" alt="Drizzle Logo" /><h2 class="text-drizzle">dri<span class="drizzle-z-skew-1">z</span><span class="drizzle-z-skew-2">z</span>le</h2>
        </a>
        
        <div class="collapse drizzle show" id="drizzleDocs" data-parent="#docsSidebar">
          <ul>
            <a href="../overview.html"><li>Overview</li></a>
            <a href="../quickstart.html"><li>Quickstart</li></a>
          </ul>
            <h3>Getting Started</h3>
            <ul>
                <a href="using-drizzles-redux-store.html"><li>Using Drizzle&#x27;s Redux Store</li></a>
                <a href="contract-interaction.html"><li>Contract Interaction</li></a>
            </ul>
            <h3>React</h3>
            <ul>
                <a href="../react/react-integration.html"><li>React Integration</li></a>
                <a href="../react/react-components.html"><li>React Components</li></a>
            </ul>
            <h3>Reference</h3>
            <ul>
                <a href="../reference/drizzle-options.html"><li>Drizzle Options</li></a>
                <a href="../reference/drizzle-state.html"><li>Drizzle State</li></a>
                <a href="../reference/drizzle-actions.html"><li>Drizzle Actions</li></a>
                <a href="../reference/how-data-stays-fresh.html"><li>How Data Stays Fresh</li></a>
            </ul>
        </div>
      </aside>
      <div class="col-lg-9 bd-light-cream docs-content">
        
    <h1 class="link-markdown">
      <a href="contract-interaction.html#contract-interaction" name="contract-interaction"><i class="fas fa-link"></i></a>
      Contract Interaction
    </h1>
  <p>Drizzle provides helpful methods on top of the default web3.Contract methods to keep your calls and transactions in sync with the store.</p>

    <h2 class="link-markdown">
      <a href="contract-interaction.html#-code-cachecall-code-" name="-code-cachecall-code-"><i class="fas fa-link"></i></a>
      <code>cacheCall()</code>
    </h2>
  <p>Gets contract data. Calling the <code>cacheCall()</code> function on a contract will execute the desired call and return a corresponding key so the data can be retrieved from the store. When a new block is received, Drizzle will refresh the store automatically _if_ any transactions in the block touched our contract. For more information on how this works, see <a href="https://truffleframework.com/docs/drizzle/reference/how-data-stays-fresh">How Data Stays Fresh</a>.</p>
<p><strong>Note:</strong> We have to check that Drizzle is initialized before fetching data. A simple if statement such as below is fine for displaying a few pieces of data, but a better approach for larger dapps is to use a <a href="https://github.com/trufflesuite/drizzle-react#recipe-loading-component">loading component</a>. We&#39;ve already built one for you in our <a href="https://github.com/trufflesuite/drizzle-react-components"><code>drizzle-react-components</code> library</a> as well.</p>
<pre><code class="lang-javascript">// Assuming we&#39;re observing the store for changes.
var state = drizzle.store.getState()

// If Drizzle is initialized (and therefore web3, accounts and contracts), continue.
if (state.drizzleStatus.initialized) {
    // Declare this call to be cached and synchronized. We&#39;ll receive the store key for recall.
    const dataKey = drizzle.contracts.SimpleStorage.methods.storedData.cacheCall()

    // Use the dataKey to display data from the store.
    return state.contracts.SimpleStorage.storedData[dataKey].value
}

// If Drizzle isn&#39;t initialized, display some loading indication.
return &#39;Loading...&#39;
</code></pre>
<p>The contract instance has all of its standard web3 properties and methods. For example, you could still call as normal if you don&#39;t want something in the store:</p>
<pre><code class="lang-javascript">drizzle.contracts.SimpleStorage.methods.storedData().call()
</code></pre>

    <h2 class="link-markdown">
      <a href="contract-interaction.html#-code-cachesend-code-" name="-code-cachesend-code-"><i class="fas fa-link"></i></a>
      <code>cacheSend()</code>
    </h2>
  <p>Sends a contract transaction. Calling the <code>cacheSend()</code> function on a contract will send the desired transaction and return a corresponding transaction hash so the status can be retrieved from the store. The last argument can optionally be an options object with the typical from, gas and gasPrice keys. Drizzle will update the transaction&#39;s state in the store (pending, success, error) and store the transaction receipt. For more information on how this works, see <a href="https://truffleframework.com/docs/drizzle/reference/how-data-stays-fresh">How Data Stays Fresh</a>.</p>
<p><strong>Note:</strong> We have to check that Drizzle is initialized before fetching data. A simple if statement such as below is fine for displaying a few pieces of data, but a better approach for larger dapps is to use a <a href="https://github.com/trufflesuite/drizzle-react#recipe-loading-component">loading component</a>. We&#39;ve already built one for you in our <a href="https://github.com/trufflesuite/drizzle-react-components"><code>drizzle-react-components</code> library</a> as well.</p>
<pre><code class="lang-javascript">// Assuming we&#39;re observing the store for changes.
var state = drizzle.store.getState()

// If Drizzle is initialized (and therefore web3, accounts and contracts), continue.
if (state.drizzleStatus.initialized) {
    // Declare this transaction to be observed. We&#39;ll receive the stackId for reference.
    const stackId = drizzle.contracts.SimpleStorage.methods.set.cacheSend(2, {from: &#39;0x3f...&#39;})

    // Use the dataKey to display the transaction status.
    if (state.transactionStack[stackId]) {
        const txHash = state.transactionStack[stackId]

        return state.transactions[txHash].status
    }
}

// If Drizzle isn&#39;t initialized, display some loading indication.
return &#39;Loading...&#39;
</code></pre>
<p>For more information on what&#39;s contained in transaction state, see <a href="https://truffleframework.com/docs/drizzle/reference/drizzle-state">Drizzle State</a>.</p>
<p>The contract instance has all of its standard web3 properties and methods. For example, you could still send as normal if you don&#39;t want a tx in the store:</p>
<pre><code class="lang-javascript">drizzle.contracts.SimpleStorage.methods.set(2).send({from: &#39;0x3f...&#39;})
</code></pre>

    <h2 class="link-markdown">
      <a href="contract-interaction.html#adding-contracts-dynamically" name="adding-contracts-dynamically"><i class="fas fa-link"></i></a>
      Adding Contracts Dynamically
    </h2>
  <p>You can programmatically add contracts to Drizzle using either <code>drizzle.addContract()</code> or the <code>ADD_CONTRACT</code> action.</p>
<pre><code class="lang-javascript">var contractConfig = {
  contractName: &quot;0x066408929e8d5Ed161e9cAA1876b60e1fBB5DB75&quot;,
  web3Contract: new web3.eth.Contract(/* ... */)
}
events = [&#39;Mint&#39;]

// Using an action
dispatch({type: &#39;ADD_CONTRACT&#39;, drizzle, contractConfig, events, web3})

// Or using the Drizzle context object
this.context.drizzle.addContract(contractConfig, events)
</code></pre>

    <h2 class="link-markdown">
      <a href="contract-interaction.html#removing-contracts-dynamically" name="removing-contracts-dynamically"><i class="fas fa-link"></i></a>
      Removing Contracts Dynamically
    </h2>
  <p>You can also delete contracts using either <code>drizzle.deleteContract()</code> or the <code>DELETE_CONTRACT</code> action.</p>
<pre><code class="lang-javascript">const contractName = &quot;MyContract&quot;

// Using an action
dispatch({type: &#39;DELETE_CONTRACT&#39;, drizzle, contractName})

// Or using the Drizzle context object
this.context.drizzle.deleteContract(contractName)
</code></pre>


        <div class="contribute-link">
          See a way to make this page better? <a href="https://github.com/trufflesuite/trufflesuite.com/edit/master/src/docs/drizzle/getting-started">Edit here &raquo;</a>
        </div>      </div>
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script>window.jQuery || document.write('<script src="../../../js/vendor/jquery-3.2.1.slim.min.js"><\/script>')</script>
  <script src="../../../js/bootstrap.min.js"></script>
  <script src="../../../js/vendor/prism.js"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <script src="../../../js/docs.js"></script>
  <script src="https://unpkg.com/lunr/lunr.js"></script>
  <script src="../../../js/docs-search.js"></script>
</body>
</html>